---
title: "HDT1"
author: "AndresEmilioQ, Mirka M, Oscar de Leon"
date: "4/2/2022"
output:
  html_document:
    code_folding: hide
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r}
library(dplyr)
datos <- read.csv("movies.csv")
```

## A continuacion los datos recopilados de la base de datos y sus caracteristicas

## El conjunto de datos esta compuesto por `r nrow(datos)` observaciones y `r ncol (datos)` variables.

## 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa 
continua, cuantitativa discreta)

```{r}
variable <- c("id", "popularity", "budget", "revenue", "original_title", "originalLanguage", "title", "homePage", "video", "director", "runtime", "genres", "genresAmount", "productionCompany", "productionCoAmount", "productionCompanyCountry", "productionCountry", "productionCountriesAmount", "releaseDate", "voteCount", "voteAvg", "actors", "actorsPopularity", "actorsCharacter", "actorsAmount", "castWomenAmount", "CastMenAmount")

tipo <- c("cuantitativa continua", "cuantitativa continua", "cuantitativa continua ", "cuantitativa continua", "cualitativa nominal", "cualitativa nominal", "cualitativa nominal", "cualitativa nominal", "cualitativa nominal", "cualitativa nominal", "cuantitativa continua", "cualitativa nominal", "cuantitativa discreta", "cualitativa nominal", "cuantitativa discreta", "cualitativa nominal", "cualitativa nominal", " cuantitativa discreta", "cualitativa nominal", "cualitativa discreta", "cuantitativa continua", "cualitativa nominal", "cuantitativa continua", "cualitativa nominal", "cuantitativa discreta", "cuantitativa discreta", "cuantitativa discreta")

numero <- 1:27

DataFrame.Variables <- data.frame(numero, variable, tipo)

print(DataFrame.Variables)
```


## 3. Investigue si las variables cuantitativas siguen una distribución normal y haga una 
tabla de frecuencias de las variables cualitativas. Explique todos los resultados.

Nos apoyamos de nuestros conocimientos previos en estadistica y utilizamos ademas la curtosis para determinar la concentracion de los datos entorno a la media. Encontramos que todas nuestras variables cuantitativas obtuvieron un coeficiente mayor a uno, es decir positivo (distribucion leptocúrtica)

Referencia y expliacion detallada: https://economipedia.com/definiciones/curtosis.html

```{r}
#Libreria necesaria para utilizar la curtosis, por favor instalar
library(e1071)

## Popularidad

popularity = datos$popularity
"Kurtosis de popularidad"
kurtosis(popularity)

#Presupuesto
budget = datos$budget
"Kurtosis de budget"
kurtosis(budget)

#Ingresos
revenue = datos$revenue
"Kurtosis de revenue"
kurtosis(revenue)

#Duración
runtime = datos$runtime
"Kurtosis de runtime"
kurtosis(runtime)

#Votos
vote_count = datos$voteCount
"Kurtosis de VoteCount"
kurtosis(vote_count)

#Promedio de votos
vote_average = datos$voteAvg
"Kurtosis de VoteAvg"
kurtosis(vote_average)

#Cantidad de generos
GenresA = datos$genresAmount
"Kurtosis de GenresAmount"
kurtosis(GenresA)

#Cantidad de co productora 
ProductionCoA = datos$productionCoAmount
"Kurtosis de productionCoAmount"
kurtosis(ProductionCoA)

#Cantidad de productoras por pais
ProducCountrieA = datos$productionCountriesAmount
"Kurtosis de ProductCountriesAmount"
kurtosis(ProducCountrieA)

#Cantidad de actores
ActorsA = datos$actorsAmount
"Kurtosis de ActorsAmount"
kurtosis(ActorsA)

#Cantiddad de actores Masculinos
#Esta kurtosis la realizamos en excel debido a que la base de datos presenta datos no numericos en ciertas celdas
ActoresM = datos$castMenAmount
ActoresM <- na.omit(ActoresM)
b <- 43.93458
"Kurtosis de CastMenAmount"
b
#kurtosis(ActoresM)

#Cantiddad de actrices Femenina
#Esta kurtosis la realizamos en excel debido a que la base de datos presenta datos no numericos en ciertas celdas
ActricesF = datos$castWomenAmount
a <- 108.7062
"Kurtosis de CastWomenAmount"
a
#kurtosis(ActricesF)
```

##### Variables cualitativas tabla de frecuencias
```{r}
library(tidyr)
#Generos
genres <- data.frame(table(do.call(c, lapply(datos$genres, function(x) unlist(strsplit(x, "\\|"))))))

#Pagina
homepage <- data.frame(table(datos$homePage))
homepage[homepage == ""] <- NA
homepage <- na.omit(homepage)

#Companias de produccion
productionCompany <- data.frame(table(do.call(c, lapply(datos$productionCompany, function(x) unlist(strsplit(x, "\\|"))))))

#pais de compania de produccion
ProductionCompanyCountry <- data.frame(table(do.call(c, lapply(datos$productionCompanyCountry, function(x) unlist(strsplit(x, "\\|"))))))

#pais productora
ProductionCountry <- data.frame(table(do.call(c, lapply(datos$productionCountry, function(x) unlist(strsplit(x, "\\|"))))))

#video
video <- data.frame(table(datos$video))
video[video == ""] <- NA
video <- na.omit(video)

#Director
director <- data.frame(table(datos$director))
director[director == ""] <- NA
director <- na.omit(director)

#Actores
actors <- data.frame(table(do.call(c, lapply(datos$actors, function(x) unlist(strsplit(x, "\\|"))))))
actors <- data.frame(table(datos$actors))
actors[actors == ""] <- NA
actors <- na.omit(actors)

#ActorsCharacter
character <- data.frame(table(do.call(c, lapply(datos$actorsCharacter, function(x) unlist(strsplit(x, "\\|"))))))
character[character == ""] <- NA
character <- na.omit(character)

#Titulo original
original_title <- data.frame(table(datos$originalTitle))

#Titulo
title <- data.frame(table(datos$title))

#Lenguaje Original
language <- data.frame(table(datos$originalLanguage))

#fecha
release_date <- data.frame(table(datos$releaseDate))
```

